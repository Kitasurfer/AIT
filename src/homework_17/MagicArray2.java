package homework_17; /* Group: 52-1, "AIT Hi-tech team" GMBH
Author: Bogdan Fesenko
Date: 06-10-2024
*/

/*
Task 1
Инкапсулировать класс нашего магического массива

Task 2 * (Опционально)
Написать метод lastIndexOf(int value) возвращающий индекс последнего вхождения значения в массиве.
 */

public class MagicArray2 {


    private int[] array; // Массив инкапсулирован (приватный защищен от прямого доступа).
    // доступ к массиву только через публ методы add(), remove(), indexOf()
    private int cursor; // Присваиваем значение по умолчанию = 0;

    // Конструктор по умолчанию
    public MagicArray2() {
        // ДЗ: Инициализируем массив на 10 элементов по умолчанию.
        array = new int[10]; // Инициализируем массив с 10 элементами.
    }

    // ДЗ: Конструктор, принимающий массив.
    // Если передан пустой массив или null, инициализируем его с 10 элементами.
    // Если передан непустой массив, создаем массив в два раза больше и добавляем элементы.
    public MagicArray2(int[] array) {
        if (array == null || array.length == 0) {
            this.array = new int[10]; // ДЗ: Если массив пустой, создаем массив из 10 элементов.
        } else {
            this.array = new int[array.length * 2]; // ДЗ: Создаем массив в 2 раза больше.
            add(array); // ДЗ: Добавляем элементы из переданного массива.
        }
    }

    // ДЗ: Метод для добавления одного элемента в массив.
    public void add(int value) {
        // ДЗ: Проверяем, есть ли свободное место в массиве.
        if (cursor == array.length - 1) {
            // ДЗ: Расширяем массив перед добавлением нового элемента.
            expandArray();
        }
        array[cursor] = value; // ДЗ: Добавляем элемент в массив по индексу курсора.
        cursor++; // ДЗ: Увеличиваем значение курсора, так как добавлен новый элемент.
    }

    // ДЗ: Метод для добавления нескольких элементов в массив.
    public void add(int... numbers) {
        // ДЗ: Добавляем каждый элемент из переданного массива в основной массив.
        for (int number : numbers) {
            add(number); // Используем метод add для каждого элемента.
        }
    }

    // ДЗ: Метод для динамического расширения массива.
    private void expandArray() {
        System.out.println("Расширяем массив! Курсор = " + cursor);
        // ДЗ: Создаем новый массив в два раза больше текущего.
        int[] newArray = new int[array.length * 2];
        // ДЗ: Копируем значения из старого массива в новый.
        for (int i = 0; i < cursor; i++) {
            newArray[i] = array[i]; // Переносим элементы.
        }
        // ДЗ: Обновляем ссылку на новый массив.
        array = newArray;
        System.out.println("Расширение массива завершено");
    }

    // ДЗ: Возвращаем строковое представление массива.
    @Override // ДЗ: Используем аннотацию @Override, чтобы переопределить метод toString().
    public String toString() {
        if (cursor == 0) return "[]"; // ДЗ: Если массив пуст, возвращаем "[]".
        StringBuilder result = new StringBuilder("[");
        for (int i = 0; i < cursor; i++) {
            result.append(array[i]).append(i < cursor - 1 ? ", " : "]"); // Формируем строку с элементами массива.
        }
        return result.toString(); // ДЗ: Возвращаем строку, представляющую массив.
    }

    // ДЗ: Возвращаем текущее количество элементов в массиве.
    public int size() {
        return cursor; // ДЗ: Количество элементов — это текущее значение курсора.
    }

    // ДЗ: Возвращаем значение элемента по индексу.
    public int get(int index) {
        if (index >= 0 && index < cursor) {
            return array[index]; // ДЗ: Если индекс корректен, возвращаем элемент по индексу.
        }
        return Integer.MIN_VALUE; // ДЗ: Если индекс некорректен, возвращаем минимальное значение.
    }

    // ДЗ: Удаление элемента по индексу.
    public int remove(int index) {
        /*
        1. ДЗ: Проверка индекса на валидность.
        2. ДЗ: Удаление значения по индексу.
        3. ДЗ: Передвижение элементов влево и уменьшение курсора.
        4. ДЗ: Возвращение удаленного значения.
        */
        if (index >= 0 && index < cursor) {
            // ДЗ: Сохраняем значение, которое будет удалено.
            int value = array[index];
            // ДЗ: Перемещаем элементы влево, начиная с удаляемого элемента.
            for (int i = index; i < cursor - 1; i++) {
                array[i] = array[i + 1];
            }
            cursor--; // ДЗ: Уменьшаем курсор, так как удалили элемент.
            return value; // ДЗ: Возвращаем удаленное значение.
        } else {
            // ДЗ: Если индекс некорректный, возвращаем минимальное значение.
            return Integer.MIN_VALUE;
        }
    }

    // ДЗ: Поиск индекса первого вхождения значения в массиве.
    public int indexOf(int value) {
        for (int i = 0; i < cursor; i++) {
            if (array[i] == value) {
                return i; // ДЗ: Возвращаем индекс первого найденного значения.
            }
        }
        return -1; // ДЗ: Если значение не найдено, возвращаем -1.
    }

    // ДЗ Task 2, Метод для поиска индекса последнего вхождения значения в массиве.
    public int lastIndexOf(int value) {
        for (int i = cursor - 1; i >= 0; i--) { // Идем с конца массива к началу.
            if (array[i] == value) {
                return i; //  Возвращаем индекс последнего найденного значения.
            }
        }
        return -1; //  Если не найдено, возвращаем -1.
    }

    //  Удаление элемента по значению.
    public boolean removeByValue(int value) {
        /*
        1.  Поиск индекса элемента с заданным значением.
        2.  Если элемент не найден, возвращаем false.
        3.  Если элемент найден, удаляем его и возвращаем true.
        */
        int index = indexOf(value); // Ищем индекс элемента.
        if (index == -1) return false; // Если элемент не найден, возвращаем false.
        remove(index); // Удаляем элемент по найденному индексу.
        return true; // Возвращаем true если элемент успешно удален.
    }

}
/*
Task 1: Инкапсуляция магического массива

Создан класс MagicArray2:
Поля array и cursor инкапсулированы с модификатором private.
Реализован метод add() для добавления одного или нескольких элементов.
Реализован метод remove() для удаления элемента по индексу.
Реализованы методы indexOf() и lastIndexOf() для поиска первого и последнего вхождения элемента.
Реализован метод removeByValue() для удаления элемента по значению.
Добавлены геттеры для получения информации об элементах массива.
Метод expandArray() для динамического расширения массива.
 */